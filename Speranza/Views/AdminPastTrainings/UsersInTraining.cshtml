@model Speranza.Models.UsersInTrainingModel


@if (Model.Users == null || Model.Users.Count == 0)
{
    <p>Na tomto tréningu nie je nikto prihlásený!</p>
}
else
{
    <table class="table table-striped table-hover" id="UsersInTrainingTable">
        <thead>
            <tr>
                <th>Meno</th>
                <th>Priezvisko</th>
                <th>Email</th>
                <th>Akcia</th>
            </tr>
            </thead>
        @foreach (var user in Model.Users)
        {
         <tr id="@user.Email">
            <td>@user.Name </td>
            <td>@user.Surname </td>
            <td>@user.Email</td>
            <td>
                @if(user.HasNoAvailableTrainings && !user.ParticipationSet)
                {
                <a href="#" class="ConfirmParticipation"  id="cp-@user.Email" data-training="@Model.TrainingID" data-email="@user.Email"><span class="glyphicon glyphicon-ok" style="color:green;"></span> Potvrď účasť</a>
                @:&nbsp;&nbsp;
                <a href="#" class="DisproveParticipation" id="dp-@user.Email" data-training="@Model.TrainingID" data-email="@user.Email"><span class="glyphicon glyphicon-remove" style="color:red;"></span> Potvrď neúčasť</a>
                }
            </td>
        </tr>
        }

        </table>

}

<script>
    $(".ConfirmParticipation").click(function () {
        var self = $(this);
        var trainingID = self.data("training");
        var email = self.data("email");
        $.ajax({
            //controller method
            url: "ConfirmParticipation",
            //controller method parameter : trainingID
            data: { trainingID: trainingID, email: email },
            type: 'POST',
            dataType: "json",
            success: function (response) {
                if(response == 15)
                {
                    $("#cp-" + email).hide();
                    $("#dp-" + email).hide();
                    $("#messageBoxParticipation").html("Účasť bola potvrdená!");
                    $("#messageBoxParticipation").show();
                }
            }
        });
    });

    $(".DisproveParticipation").click(function () {
        var self = $(this);
        var trainingID = self.data("training");
        var email = self.data("email");
        $.ajax({
            //controller method
            url: "DisproveParticipation",
            //controller method parameter : trainingID
            data: { trainingID: trainingID, email: email },
            type: 'POST',
            dataType: "json",
            success: function (response) {
                if (response == 16) {
                    $("#cp-" + email).hide();
                    $("#dp-" + email).hide();
                    $("#messageBoxParticipation").html("Neúčasť bola potvrdená!");
                    $("#messageBoxParticipation").show();
                }
            }
        });
    });

</script>