@model Speranza.Models.UsersInTrainingModel

<div id="messageBoxTrainingDetails" style="display:none;" class="alert alert-success" role="alert"></div>


@if (Model.Users == null || Model.Users.Count == 0)
{
    <p>Na tomto tréningu nie je nikto prihlásený!</p>
}
else
{
    <table class="table table-striped table-hover" id="myTable">
        <thead>
            <tr>
                <th>Meno</th>
                <th>Priezvisko</th>
                <th>Email</th>
                <th>Akcia</th>
            </tr>
            </thead>
        @foreach (var user in Model.Users)
        {
         <tr id="@Model.TrainingID">
            <td>@user.Name </td>
            <td>@user.Surname </td>
            <td>@user.Email</td>
             <td><a class="UserSignOutFromTraining" data-email="@user.Email" data-training="@Model.TrainingID" href="#">Odhlás používateľa</a></td>
        </tr>
        }

        </table>

}

<script>
    $(function () {
        $('.UserSignOutFromTraining').click(function () {
            var self = $(this);
            var id = self.data('email');
            var training = self.data('training');
            $.ajax({
                url: '@Url.Content("~/AdminUsers/SignOutFromTraining")',
                data: { id: id, training: training },
                type: 'POST',
                dataType: "json",
                success: function (response) {
                    if (response.Message == 6) {
                        $('#' + training).remove();
                        $('#messageBoxTrainingDetails').html("Užívateľ <b>" + response.Email + "</b> bol úspešne odhlásený z tréningu <b>" + response.TrainingDate + "</b> o: <b>" + response.TrainingTime + "</b>!");
                        $('#messageBoxTrainingDetails').show();
                        $('#' + training + '-RegisteredNumber').html($('#' + training + '-RegisteredNumber').html()-1);
                    }
                }
            });

        });
    });

    </script>